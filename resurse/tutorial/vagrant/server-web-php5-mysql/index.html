<!DOCTYPE html> <!--[if IE 8]> <html lang="ro" class="ie8"> <![endif]--> <!--[if IE 9]> <html lang="ro" class="ie9"> <![endif]--> <!--[if !IE]><!--> <html lang="ro"> <!--<![endif]--> <head> <title>Vagrant - Server web (PHP5 & MySQL)</title> <!-- Meta --> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta name="description" lang="ro" xml:lang="ro" content="Situl dedicat laboratoarelor susținute în cadrul Facultății de Informatică din Iași." /> <meta name="keywords" lang="en" xml:lang="en" content="Web, WWW, technology, course, Romania, Iasi, Computer Science, university, academic, information, education, school, project, lang programming, document, software, application, student, grade" /> <meta name="keywords" lang="ro" xml:lang="ro" content="Web, WWW, technologie, curs, Romania, Iasi, Informatica, universitate, academic, informatie, educatie, scoala, proiect, limbaj, programare, document, software, aplicatie, student, nota" /> <link rel="shortcut icon" href="/assets/images/favicon.ico"> <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'> <!-- Global CSS --> <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"> <!-- Plugins CSS --> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/5.3.0/ekko-lightbox.css"> <!-- Theme CSS --> <link id="theme-style" rel="stylesheet" href="/assets/css/main.css"> <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries --> <!--[if lt IE 9]> <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script> <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script> <![endif]--> <link rel="canonical" href="https://teaching.alexcoman.com/resurse/tutorial/vagrant/server-web-php5-mysql/"> <link rel="alternate" type="application/rss+xml" title="" href="/feed.xml"> <script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" integrity="sha256-3YM6A3pH4QFCl9WbSU8oXF5N6W/2ylvW0o2g+Z6TmLQ=" crossorigin="anonymous" /> </head> <body > <div class="page-wrapper"> <header id="header" class="header "> <div class="container"> <div class="branding"> <h1 class="logo"> <a href="/resurse/tutorial/vagrant/server-web-php5-mysql/"> <span aria-hidden="true" class="icon fas fa-laptop"></span> <span class="text-highlight">Laboratoare</span> <span class="text">@FII</span> </a> </h1> </div> <ol class="breadcrumb"> <li><a href="/">Acasă</a></li> <li><a href="/resurse">Resurse</a></li> <li><a href="/resurse/tutorial">Tutorial</a></li> <li><a href="/resurse/tutorial/vagrant">Vagrant</a></li> <li class="active">Vagrant - Server web (PHP5 & MySQL)</li> </ol> </div> </header> <section id="blog_post" class="blog-post-section doc-wrapper"> <div class="container"> <div id="doc-header" class="doc-header text-center"> <h1 class="doc-title" itemprop="name headline"> <i class="icon fas fa-paper-plane"></i> Vagrant - Server web (PHP5 &amp; MySQL) </h1> <div class="meta"> Publicat de: <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name">Alexandru Coman</span> </span> pe <i class="fas fa-clock"></i> <time datetime="2017-04-04T12:00:00+00:00" itemprop="datePublished"> 4 aprilie 2017 </time> </div> </div> <div class="doc-body"> <div class="doc-content"> <div class="content-inner"> <section id="dashboards" class="doc-section"> <div class="section-block"> <p>În cadrul acestui tutorial o să discutăm despre modul în care putem pregăti într-o manieră cât mai ușoară un mediu de execuție pentru o aplicație <a href="http://php.net/">PHP</a> ce folosește <a href="https://www.mysql.com/">MySQL</a> ca și bază de date. <!--more--></p> <h2 id="resurse-necesare">Resurse necesare</h2> <p>Pentru pregătirea mediului de execuție o să folosim utilitarul <a href="https://www.vagrantup.com/">Vagrant</a> și hypervisorul <a href="https://www.virtualbox.org/">VirtualBox</a>.</p> <p><a href="https://www.virtualbox.org/">VirtualBox</a> este o aplicație ce ne permite să virtualizăm o mașină fizică (un computer). Cu ajutorul său, putem să creăm o mașină virtuală după specificațiile oferite de noi, ce va conține un sistem de operare izolat de sistemul de operare al mașinii gazdă. Mai multe detalii pot fi găsite în tutorialul <a href="/resurse/tutorial/virtualbox/notiuni-introductive/">VirtualBox - noțiuni introductive</a>.</p> <p><a href="https://www.vagrantup.com/">Vagrant</a> este un sistem de configurare, distribuție și virtualizare a mediilor de lucru, dezvoltare și publicare. El permite prin o mulțime de aplicații externe, configurarea, aprovizionarea și distribuirea ușoară a mașinilor virtuale, cu scopul de a standardiza și ușura pregătirea unui mediu pentru dezvoltarea sau publicarea unei aplicații sau a obține accesul la unelte necesare lucrului, disponibile doar pe anumite sisteme de operare. Mai multe detalii pot fi găsite în tutorialul <a href="/resurse/tutorial/vagrant/notiuni-introductive/">Vagrant - Noțiuni introductive</a>.</p> <h2 id="pregătirea-mediului-de-lucru">Pregătirea mediului de lucru</h2> <p>Pentru pregătirea mediului de execuție o să avem nevoie de un fișier de configurare (fișierul <code class="highlighter-rouge">Vagrantfile</code>) și o serie de scripturi care să se ocupe de pregătirea mediului de execuție.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Alegem un director de lucru cât mai convenabil</span>
~ <span class="nv">$ </span><span class="nb">mkdir</span> <span class="nt">-p</span> ~/tehnologii-web/tuxy-bot
~ <span class="nv">$ </span><span class="nb">cd</span> ~/tehnologii-web/tuxy-bot

<span class="c"># Facem o copie locală a depozitului de cod labs</span>
~ <span class="nv">$ </span>git clone https://github.com/alexcoman/labs

<span class="c"># Copiem din depozitul de cod fișierele de interes</span>
~ <span class="nv">$ </span><span class="nb">cp</span> <span class="nt">-r</span> labs/web/unelte/vagrant/webserver/. <span class="nb">.</span>

<span class="c"># Ștergem depozitul de cod</span>
~ <span class="nv">$ </span><span class="nb">rm</span> <span class="nt">-rf</span> labs
</code></pre></div></div> <p>Acum în directorul curent ar trebui să avem următoarea structură de directoare:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">.</span>
├── provision
│   ├── nginx
│   │   ├── conf.d
│   │   │   └── sauce.conf
│   │   ├── fastcgi_params
│   │   ├── koi-utf
│   │   ├── koi-win
│   │   ├── mime.types
│   │   ├── nginx.conf
│   │   ├── scgi_params
│   │   ├── uwsgi_params
│   │   └── win-utf
│   ├── nginx.sh
│   ├── php.ini
│   └── vagrant.sh
├── README.md
└── Vagrantfile
</code></pre></div></div> <h3 id="fișierul-de-configurare">Fișierul de configurare</h3> <p>Înainte de a trece la pasul următor, va trebui să verificăm dacă fișierul de configurare <code class="highlighter-rouge">Vagrantfile</code> conține specificațiile pe care ni le dorim (de exemplu: numărul de procesoare, adresa ip etc).</p> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">api_version</span> <span class="o">=</span> <span class="s1">'2'</span>
<span class="n">provider</span>    <span class="o">=</span> <span class="s1">'virtualbox'</span>
<span class="n">box</span>         <span class="o">=</span> <span class="s1">'hashicorp/precise64'</span>
<span class="n">hostname</span>    <span class="o">=</span> <span class="s1">'webserver'</span>
<span class="n">ip_address</span>  <span class="o">=</span> <span class="s1">'192.168.50.210'</span>
<span class="n">ram</span>         <span class="o">=</span> <span class="s1">'1024'</span>
<span class="n">cpus</span>        <span class="o">=</span> <span class="s1">'2'</span>

<span class="no">Vagrant</span><span class="p">.</span><span class="nf">configure</span><span class="p">(</span><span class="n">api_version</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">define</span> <span class="s2">"webserver"</span> <span class="k">do</span> <span class="o">|</span><span class="n">webserver</span><span class="o">|</span>
    <span class="k">end</span>

    <span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">box</span> <span class="o">=</span> <span class="n">box</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">host_name</span> <span class="o">=</span> <span class="n">hostname</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">network</span> <span class="ss">:private_network</span><span class="p">,</span> <span class="ss">ip: </span><span class="n">ip_address</span>

    <span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">provider</span> <span class="ss">:virtualbox</span> <span class="k">do</span> <span class="o">|</span><span class="n">virtualbox</span><span class="o">|</span>
        <span class="n">virtualbox</span><span class="p">.</span><span class="nf">name</span> <span class="o">=</span> <span class="n">hostname</span>
        <span class="n">virtualbox</span><span class="p">.</span><span class="nf">memory</span> <span class="o">=</span> <span class="n">ram</span>
        <span class="n">virtualbox</span><span class="p">.</span><span class="nf">cpus</span> <span class="o">=</span> <span class="n">cpus</span>
    <span class="k">end</span>

    <span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">provision</span> <span class="s2">"shell"</span> <span class="k">do</span> <span class="o">|</span><span class="n">setup</span><span class="o">|</span>
        <span class="n">setup</span><span class="p">.</span><span class="nf">path</span> <span class="o">=</span> <span class="s2">"provision/vagrant.sh"</span>
        <span class="n">setup</span><span class="p">.</span><span class="nf">privileged</span> <span class="o">=</span> <span class="kp">true</span>
    <span class="k">end</span>

    <span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">provision</span> <span class="s2">"shell"</span> <span class="p">,</span><span class="ss">run: </span><span class="s2">"always"</span> <span class="k">do</span> <span class="o">|</span><span class="n">setup</span><span class="o">|</span>
        <span class="n">setup</span><span class="p">.</span><span class="nf">path</span> <span class="o">=</span> <span class="s2">"provision/nginx.sh"</span>
        <span class="n">setup</span><span class="p">.</span><span class="nf">privileged</span> <span class="o">=</span> <span class="kp">true</span>
    <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div> <h2 id="pregătirea-mediului-de-execuție">Pregătirea mediului de execuție</h2> <p>După ce am descărcat și modificat după caz toate fișierele de care avem nevoie, putem să pregătim mediul de execuție pentru aplicația dorită.</p> <h3 id="crearea-mașinii-virtuale">Crearea mașinii virtuale</h3> <p>Pentru a începe pregătirea mediului de execuție putem folosi comanda <code class="highlighter-rouge">vagrant up</code>:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~ <span class="nv">$ </span>vagrant up

<span class="o">==&gt;</span> webserver: Adăugăm sursa de pachete pentru PHP5.
<span class="o">==&gt;</span> webserver: + <span class="nb">echo</span> <span class="s1">'Adăugăm sursa de pachete pentru nginx.'</span>
<span class="o">==&gt;</span> webserver: Adăugăm opțiunile dorite pentru serverul de mysql.
<span class="o">==&gt;</span> webserver: Instalăm pachetele dorite
<span class="o">==&gt;</span> webserver: Configurăm serverul web.
<span class="o">==&gt;</span> webserver: Deschidem portul 80.
<span class="o">==&gt;</span> webserver: Repornim serviciile.
<span class="o">==&gt;</span> webserver: Am terminat.
</code></pre></div></div> <h3 id="interacțiunea-cu-mediul-de-execuție">Interacțiunea cu mediul de execuție</h3> <p>După ce execuția comenzii anterioare s-a finalizat putem observa că au fost create două directoare noi:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">.</span>
├── .log
│   ├── nginx-access.log
│   ├── nginx-error.log
│   └── php-access.log
└── .www
</code></pre></div></div> <ul> <li><code class="highlighter-rouge">.www</code> care va conține aplicația dumneavoastră</li> <li><code class="highlighter-rouge">.logs</code> care va conține fișierele de log</li> </ul> <h4 id="verificăm-dacă-serverul-web-este-funțional">Verificăm dacă serverul web este funțional</h4> <p>Pentru a ușura interacțiunea cu serverul web putem adăuga o nouă intrare în fișierul <code class="highlighter-rouge">/etc/hosts</code>.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo echo</span> <span class="s2">"192.168.50.210	webserver.local"</span> <span class="o">&gt;&gt;</span> /etc/hosts
</code></pre></div></div> <p>Pregătim un script PHP de test:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~ <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"&lt;?php echo 'OK.'; ?&gt;"</span> <span class="o">&gt;</span> .www/index.php
~ <span class="nv">$ </span><span class="nb">chmod </span>755 .www/index.php
</code></pre></div></div> <p>Trimitem o cerere HTTP către serverul web.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~ $ wget http://webserver.local/
Resolving webserver.local (webserver.local)... 192.168.50.210
Connecting to webserver.local (webserver.local)|192.168.50.210|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: unspecified [text/html]
Saving to: ‘index.html’
(488 KB/s) - ‘index.html’ saved [3]
</code></pre></div></div> <p>Verificăm dacă răspunsul este cel așteptat.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~ $ cat index.html
OK.
</code></pre></div></div> </div> </section> </div> </div> <div class="toc-sidebar hidden-xs"> <nav id="toc-nav"> <ul id="toc-menu" class="toc-menu nav nav-stacked" data-spy="affix" data-offset-top="180"> <li><a class="scrollto" href="#resurse-necesare">Resurse necesare</a> </li> <li><a class="scrollto" href="#pregătirea-mediului-de-lucru">Pregătirea mediului de lucru</a> <ul class="toc-sub-menu nav nav-stacked"> <li><a class="scrollto" href="#fișierul-de-configurare">Fișierul de configurare</a> </li></ul></li> <li><a class="scrollto" href="#pregătirea-mediului-de-execuție">Pregătirea mediului de execuție</a> <ul class="toc-sub-menu nav nav-stacked"> <li><a class="scrollto" href="#crearea-mașinii-virtuale">Crearea mașinii virtuale</a> </li> <li><a class="scrollto" href="#interacțiunea-cu-mediul-de-execuție">Interacțiunea cu mediul de execuție</a> <ul class="toc-sub-menu nav nav-stacked"> <li><a class="scrollto" href="#verificăm-dacă-serverul-web-este-funțional">Verificăm dacă serverul web este funțional</a> </li></ul></li> </ul> </nav> </div> </div> </div> </section> </div> <footer class="footer text-center"> <div class="container-fluid"> <div class="row"> <div class="col-md-2 col-xs-6"> <small class="copyright"> Bazat pe <a href="https://github.com/xriley/PrettyDocs-Theme" target="_blank">PrettyDocs</a>, dezvoltat de <a href="http://themes.3rdwavemedia.com/" target="_blank">Xiaoying Riley</a>. </small> </div> <div class="offset-md-2 col-md-8 col-xs-6"> <small> Ultima actualizare: 9 mai 2019 / <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="Conținut licențiat sub termenii Attribution-NonCommercial-ShareAlike 4.0 International">CC</a> <br/><a href="https://teaching.alexcoman.com" title="Spre situl Web al titularului laboratorului Alexandru Coman.">Alexandru Coman</a> </small> </div> </div> </div> </footer> <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script> <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-scrollTo/2.1.2/jquery.scrollTo.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.matchHeight/0.7.2/jquery.matchHeight-min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/5.3.0/ekko-lightbox.min.js"></script> <script src="/assets/js/main.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script> <script>hljs.initHighlightingOnLoad();</script> </body> </html>
