<!DOCTYPE html> <!--[if IE 8]> <html lang="ro" class="ie8"> <![endif]--> <!--[if IE 9]> <html lang="ro" class="ie9"> <![endif]--> <!--[if !IE]><!--> <html lang="ro"> <!--<![endif]--> <head> <title>Docker - Imagini</title> <!-- Meta --> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta name="description" lang="ro" xml:lang="ro" content="Situl dedicat laboratoarelor susținute în cadrul Facultății de Informatică din Iași." /> <meta name="keywords" lang="en" xml:lang="en" content="Web, WWW, technology, course, Romania, Iasi, Computer Science, university, academic, information, education, school, project, lang programming, document, software, application, student, grade" /> <meta name="keywords" lang="ro" xml:lang="ro" content="Web, WWW, technologie, curs, Romania, Iasi, Informatica, universitate, academic, informatie, educatie, scoala, proiect, limbaj, programare, document, software, aplicatie, student, nota" /> <link rel="shortcut icon" href="/assets/images/favicon.ico"> <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'> <!-- Global CSS --> <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"> <!-- Plugins CSS --> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/5.3.0/ekko-lightbox.css"> <!-- Theme CSS --> <link id="theme-style" rel="stylesheet" href="/assets/css/main.css"> <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries --> <!--[if lt IE 9]> <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script> <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script> <![endif]--> <link rel="canonical" href="https://teaching.alexcoman.com/resurse/tutorial/docker/docker-imagini/"> <link rel="alternate" type="application/rss+xml" title="" href="/feed.xml"> <script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" integrity="sha256-3YM6A3pH4QFCl9WbSU8oXF5N6W/2ylvW0o2g+Z6TmLQ=" crossorigin="anonymous" /> </head> <body > <div class="page-wrapper"> <header id="header" class="header "> <div class="container"> <div class="branding"> <h1 class="logo"> <a href="/resurse/tutorial/docker/docker-imagini/"> <span aria-hidden="true" class="icon fas fa-laptop"></span> <span class="text-highlight">Laboratoare</span> <span class="text">@FII</span> </a> </h1> </div> <ol class="breadcrumb"> <li><a href="/">Acasă</a></li> <li><a href="/resurse">Resurse</a></li> <li><a href="/resurse/tutorial">Tutorial</a></li> <li><a href="/resurse/tutorial/docker">Docker</a></li> <li class="active">Docker - Imagini</li> </ol> </div> </header> <section id="blog_post" class="blog-post-section doc-wrapper"> <div class="container"> <div id="doc-header" class="doc-header text-center"> <h1 class="doc-title" itemprop="name headline"> <i class="icon fas fa-paper-plane"></i> Docker - Imagini </h1> <div class="meta"> Publicat de: <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name">Gabriel Paiu</span> </span> pe <i class="fas fa-clock"></i> <time datetime="2017-03-13T08:00:00+00:00" itemprop="datePublished"> 13 martie 2017 </time> </div> </div> <div class="doc-body"> <div class="doc-content"> <div class="content-inner"> <section id="dashboards" class="doc-section"> <div class="section-block"> <!--more--> <h2 id="ce-este-o-imagine">Ce este o imagine</h2> <p>O imagine reprezinta contextul unui proces containerizat.</p> <p>O imagine poate fi una de bază sau extinsă - pornind de la oricare tip de imagine (fie de bază, fie extinsă). Ca referință pentru construcția unei imagini de bază va puteți consulta cu documentația menționata in referințe.</p> <p>Extinderea imaginilor se face folosind un fișier care conține una sau mai multe instrucțiuni prin care vom specifica descrierea containerului precum și a contextului acestuia. Generic, acest tip de fișier se numește Dockerfile și este numele implicit pe care comanda ”docker build” îl va căuta atunci cand va fi executată.</p> <h2 id="dockerfile">Dockerfile</h2> <p>Fiecare linie din Dockerfile va respecta urmatoarea sintaxă:</p> <p>INSTRUCȚIUNE conținut</p> <p>O trecere în revistă a unor instrucțiuni folosite frecvent, precum și un exemplu de folosire pentru fiecare:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># construiește imaginea pornind de la o imagine existentă numita ”centos”, versiunea ”latest”</span>
FROM centos:latest

<span class="c"># execută o comandă în timpul construirii imaginii</span>
RUN yum <span class="nb">install </span>git

<span class="c"># din acest punct, orice comandă ulterioară va fi executată sub user-ul ”gpaiu”</span>
USER gpaiu<span class="sb">`</span>

<span class="c"># atunci când vom porni containerul, va fi executată comanda /usr/sbin/haproxy cu parametrii respectivi</span>
ENTRYPOINT /usr/sbin/haproxy <span class="nt">-f</span> /etc/haproxy.cfg

<span class="c"># copie haproxy.cfg de pe host în container la locația /etc/haproxy.cfg</span>
COPY haproxy.cfg /etc/haproxy.cfg

<span class="c"># Publică doar la nivel informativ porturile pe care există aplicații în container</span>
EXPOSE 80/tcp
</code></pre></div></div> <p>Concret, cum se extinde o imagine? Pornind de la premiza că am creat un Dockerfile valid, putem executa ”docker build .” în directorul curent. Punctul din comanda rulată va specifica ”build context”. Cand procesul de construcție va fi inițializat, întregul director va fi trimis către Docker, recursiv. În consecință, un sfat ar fi sa ținem în directorul ”build context” doar Dockerfile și doar fișiere relevante pentru imaginea respectivă.</p> <p>Totodată ne putem gândi că repetarea acestui proces poate crea confuzii din cauza numărului mare de imagini ce va fi acumulat. În consecință, unei imagini îi putem atribui un tag pentru a o putea diferenția de celelalte sau mai ales pentru a implementa versionare la nivel de aplicații. Presupunând că intenția noastră este sa creem o aplicație de tip front-end, tag-ul nostru și versiunea pot fi ”frontend:1.0”. În consecință, comanda noastra devine:</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker build -t ”frontend:1.0” .
</code></pre></div></div> <h2 id="interactiunea-cu-imagini">Interactiunea cu imagini</h2> <p>Se poate realiza prin următoarele metode:</p> <ul> <li>sistemul de management al imaginilor oferit de sub-comanda “docker image”</li> <li>sub-comenzi ale comenzii “docker” care se adresează imaginilor în mod explicit (docker build, pull, push, rmi etc.)</li> </ul> <p>Spre deosebire de lucru cu containere, imaginile - definind un context pentru containere - sunt stocate fizic într-o locație, într-un mod similar cu pachetele de Linux care sunt stocate în repository-uri. Aceste locații se numesc regiștri iar Docker oferă un registru public numit DockerHub, care este și opțiunea implicită atunci cand efectuăm un “docker pull IMAGE:TAG” fară a specifica registrul în care vrem să căutăm acea imagine.</p> <p>Nu este strict necesar să folosim un registru public, dat fiind că, cel mai probabil, nu vrem ca informațiile noastre sa ajungă publice tot timpul. În consecință, avem opțiunea de a configura un registru în cadrul infrastructurii noastre, care să nu fie făcut public, cu disponibil numai nouă.</p> <h2 id="resurse">Resurse</h2> <p><a href="https://docs.docker.com/engine/reference/commandline/image/">docker image</a> - Modul al comenzii “docker” dedicat interacțiunii cu imagini</p> <p><a href="https://docs.docker.com/engine/reference/commandline/build/">docker build</a> - Construiește o imagine cu un anumit context</p> <p><a href="https://docs.docker.com/engine/reference/commandline/rmi/">docker rmi</a> - Șterge o imagine</p> <p><a href="https://docs.docker.com/engine/reference/commandline/search/">docker search</a> - Caută o imagine într-un registru</p> <p><a href="https://docs.docker.com/engine/reference/commandline/pull/">docker pull</a> - Descarcă local o imagine dintr-un registru</p> <p><a href="https://docs.docker.com/engine/reference/commandline/tag/">docker tag</a> - Aplică un tag unei imagini</p> </div> </section> </div> </div> <div class="toc-sidebar hidden-xs"> <nav id="toc-nav"> <ul id="toc-menu" class="toc-menu nav nav-stacked" data-spy="affix" data-offset-top="180"> <li><a class="scrollto" href="#ce-este-o-imagine">Ce este o imagine</a> </li> <li><a class="scrollto" href="#dockerfile">Dockerfile</a> </li> <li><a class="scrollto" href="#interactiunea-cu-imagini">Interactiunea cu imagini</a> </li> <li><a class="scrollto" href="#resurse">Resurse</a> </li> </ul> </nav> </div> </div> </div> </section> </div> <footer class="footer text-center"> <div class="container-fluid"> <div class="row"> <div class="col-md-2 col-xs-6"> <small class="copyright"> Bazat pe <a href="https://github.com/xriley/PrettyDocs-Theme" target="_blank">PrettyDocs</a>, dezvoltat de <a href="http://themes.3rdwavemedia.com/" target="_blank">Xiaoying Riley</a>. </small> </div> <div class="offset-md-2 col-md-8 col-xs-6"> <small> Ultima actualizare: 19 iunie 2019 / <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="Conținut licențiat sub termenii Attribution-NonCommercial-ShareAlike 4.0 International">CC</a> <br/><a href="https://teaching.alexcoman.com" title="Spre situl Web al titularului laboratorului Alexandru Coman.">Alexandru Coman</a> </small> </div> </div> </div> </footer> <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script> <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-scrollTo/2.1.2/jquery.scrollTo.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.matchHeight/0.7.2/jquery.matchHeight-min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/5.3.0/ekko-lightbox.min.js"></script> <script src="/assets/js/main.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script> <script>hljs.initHighlightingOnLoad();</script> </body> </html>
